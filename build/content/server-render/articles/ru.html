<h1>Серверный рендер</h1>

<p>
  Для того чтобы опробовать серверный рендер в действии
  воспользуйтесь <a href='/ru/boilerplate' class='navigate_link'>готовым каркасом</a>.
  <br>
  <br>
  Далее мы будем разбирать ее:
</p>

<h2>
  Алгоритм серверного рендера
</h2>

<img src="/content/server-render/images/ssr-algo-ru.jpg">

<h2>Создание сервера</h2>

<p>/build/server/index.js</p>

{{ create-server }}

<p>
  Сервер принимает запрос, и находит соответствующий ему маршрут и контроллер.
</p>

<a href='/ru/createServer' class='navigate_link'>Подробнее о создании сервера</a>


<h2>Контроллер</h2>

<p>/build/controllers/WelcomeController.js</p>

{{ controller }}

<p>
  Контроллер возвращает <b>код ответа</b>, <b>название компонента</b> и его <b>параметры props</b>.
  <br>
  <br>
  После этого сервер находит в папке /build/containers запрашиваемый компонент и
  создает из него виртуальное дерево. На основе этого дерева он создает html строку, помещает ее
  в ваш основной шаблон (layout) и отправляет запрос браузеру.
  <br>
  <br>
  Также вместе с основным шаблоном в теге script#app-cache сервер размещает JSON строку с данными из
  request.send(). Делается это для того чтобы в браузере не вызывать контроллер лишний раз.
</p>


<h2>Браузерная навигация</h2>

<p>/build/index.js</p>

{{ browser-navigation }}

<p>Браузер получил ответ от сервера. Теперь нам надо построить <b>два виртуальных дерева</b>.</p>


<p><b>1-ое дерево</b> мы строим на основе DOM который предоставил нам браузер.</p>

<p><b>2-ое дерево</b> мы строим на основе JSON кеша контроллера из тега script, упомянутом выше.</p>

<p>
  Теперь метод render сравнит два дерева и восстановит между ними разницу.
  А именно, навесит недостающие события, и пройдет полностью по всему жизненному цилку колбеков каждого компонента.
</p>

<a href='/ru/browser-navigation' class='navigate_link'>Подробнее о браузерной навигации</a>
